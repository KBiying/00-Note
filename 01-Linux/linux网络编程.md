 

# 网络模型架构

TCP/IP 协议栈

应用层:

基于TCP和UDP实现了很多应用层协议,基于TCP的FTP,telenet,http.基于UDP的FTP,SNMP,DNS,SAMBA

传输层:

提供主机之间可以进行会话的机制.传输层中定义的两种协议:TCP(transmission control protocol), UDP(user datagram protocol).TCP在不可靠IP上实现可靠连接,通过发送**窗口控制\超时重发\分包**等方法将一台主机发出的字节流发往其他主机.

网络层:

是整个TCP/IP协议栈的核心.他将数据包进行分组并发往目的主机或者网络,这造成分组之间到达目的网络或者主机顺序不是原来发送分组的顺序,需要在本层**对分组进行排序.**网络互联层定义了数据包的分组格式和协议--IP协议(Internet protocol),因此网络互联层一般又称为IP层.网络互联层功能:**路由,网际互连,拥塞控制.**

IP头部字段:

|版本|首部长度|总长度|生存时间(TTL)|片偏移|协议类型|头部校验和|源ip|目的ip|数据



# HTTP

基于客户端/服务器之间的请求响应进行交互的

HTTP通信通常发生在TCP/IP连接之上.默认端口是TCP协议的80端口.

信息交换过程

1.建立连接.socket

2.发送请求.

3.发送响应

4.关闭连接

# UDP

​	UDP协议把应用程序需要传递的数据发送出去,不提供发送数据包的顺序;接收方不向发送方发送接受的确认信息,如果出现丢包重包的现象,也不会向发送方发送反馈,因此不能保证使用UDP协议的程序发送的数据一定到达了接收方或者到达接收方的数据顺序和发送方是一致的.

**使用UDP协议传输数据的应用程序,必须自己构建发送数据的顺序机制和发送接收的确认机制,以保证发送数据的正确到达.**

UDP数据格式:

|源端口号|目的端口号|UDP数据长度|UDP校验和|数据

### UDP协议程序设计中的几个问题

#### recvfrom是阻塞函数

udp报文丢失数据后,client,server端的recvfrom()会一直阻塞,直到数据到来.

#### UDP数据发送的乱序

对于乱序的解决方法:可以采用发送端在数据段中加入数据报序号的方法,这样接收端对接收到数据的头端进行简单滴处理就可以重新获得原始顺序的数据.

#### UDP中的connect()函数

#### UDP缺乏流量控制

如果用户没有及时地从缓冲区中将数据复制出来,后面到来的数据就会接着向缓冲区中放入,当缓冲区满的时候,后面到来的数据就会覆盖之前的数据,造成数据丢失.





#### multicast

- 使用同一个 IP 多播地址接收多播数据包的所有主机构成了一个主机组，也称为多播组。一个多播组的成员是随时变动的，一台主机可以随时加入或离开多播组，多播组成员的数目和所在的地理位置也不受限制，一台主机也可以属于几个多播组。
- 设备驱动程序就必须接收所有多播数据帧，然后对它们进行过滤，这个过滤过程是网络驱动或IP层自动完成。（设备驱动程序会对多播数据进行过滤，将其发到相应的位置）

